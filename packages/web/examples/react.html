<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BeadsChartReact 全配置示例</title>
    <style>
      body { font-family: system-ui, sans-serif; margin: 16px; background: #fff; color: #111; }
      .panel label { margin-right: 12px; }
      .panel input, .panel select { margin-left: 4px; }
    </style>
    <script type="importmap">
      {
        "imports": {
          "react": "https://esm.sh/react@18.3.1?dev",
          "react-dom/client": "https://esm.sh/react-dom@18.3.1/client?dev"
        }
      }
    </script>
    <!-- 加载 PixiJS UMD 以提供 globalThis.PIXI，供 PixiRenderer 使用 -->
    <script src="https://cdn.jsdelivr.net/npm/pixi.js@7/dist/pixi.min.js"></script>
  </head>
  <body>
    <h1>React 组件版 BeadsChart（完整配置预览）</h1>
    <div id="root"></div>
    <script type="module">
      import React from 'react'
      import { createRoot } from 'react-dom/client'
      import { BeadsChartReact } from '../dist/index2.js'

      function App() {
        const width = 16
        const height = 16
        const beadSize = 24

        const [showColorCodes, setShowColorCodes] = React.useState(true)
        const [segmentation, setSegmentation] = React.useState({ blockWidth: 4, blockHeight: 4, showLabels: true, lineColor: '#999', lineWidth: 1, labelColor: '#666' })
        const [interaction, setInteraction] = React.useState({ hoverHighlight: true, hoverStroke: '#333', hoverAlpha: 0.7, selectStroke: '#1f78b4', selectAlpha: 0.9, enableClickSelect: true })
        const [zoom, setZoom] = React.useState({ enabled: true, min: 0.5, max: 3, factor: 1.2 })
        const [pan, setPan] = React.useState({ enabled: true })
        const [editEnabled, setEditEnabled] = React.useState(true)
        const [editTool, setEditTool] = React.useState('paint')
        const [brushBead, setBrushBead] = React.useState({ name: 'A', rgb: { r: 220, g: 220, b: 220 } })

        const beads = React.useMemo(() => Array.from({ length: width * height }, (_, i) => {
          const x = i % width
          const y = Math.floor(i / width)
          const c = (x + y) % 2 === 0 ? { r: 240, g: 200, b: 200 } : { r: 180, g: 220, b: 240 }
          return { id: i, x, y, color: c, name: (x + y) % 2 === 0 ? 'R' : 'B' }
        }), [width, height])

        const chartProps = {
          className: 'chart',
          style: { display: 'inline-block', border: '1px solid #ddd', background: '#fff' },
          dimensions: { width, height },
          beadData: beads,
          showColorCodes,
          codeLabelOptions: { codeLabelColor: '#222', codeLabelAutoContrast: true, codeLabelMinSize: 12, codeLabelFont: '14px system-ui' },
          segmentation,
          interaction,
          zoom,
          pan,
          editEnabled,
          editTool,
          brushBead,
          onHover: (e) => console.log('hover', e),
          onClick: (e) => console.log('click', e),
          onSelectionChange: (e) => console.log('selection-change', e),
          onEditChange: (e) => console.log('edit-change', e),
        }

        return React.createElement('div', null,
          React.createElement('div', { className: 'panel', style: { marginBottom: '12px' } },
            React.createElement('label', null,
              React.createElement('input', { type: 'checkbox', checked: showColorCodes, onChange: (ev) => setShowColorCodes(ev.target.checked) }), ' 显示色号'
            ),
            React.createElement('label', null,
              React.createElement('input', { type: 'checkbox', checked: zoom.enabled, onChange: (ev) => setZoom({ ...zoom, enabled: ev.target.checked }) }), ' 启用缩放'
            ),
            React.createElement('label', null,
              React.createElement('input', { type: 'checkbox', checked: pan.enabled, onChange: (ev) => setPan({ enabled: ev.target.checked }) }), ' 启用平移'
            ),
            React.createElement('label', null,
              React.createElement('input', { type: 'checkbox', checked: editEnabled, onChange: (ev) => setEditEnabled(ev.target.checked) }), ' 启用编辑'
            ),
            React.createElement('label', null,
              ' 工具：',
              React.createElement('select', { value: editTool, onChange: (ev) => setEditTool(ev.target.value) },
                React.createElement('option', { value: 'paint' }, '画笔'),
                React.createElement('option', { value: 'flood' }, '洪泛填充')
              )
            ),
            React.createElement('button', { style: { marginLeft: '12px' }, onClick: () => setBrushBead({ name: 'A', rgb: { r: 220, g: 220, b: 220 } }) }, '画笔 A'),
            React.createElement('button', { style: { marginLeft: '6px' }, onClick: () => setBrushBead({ name: 'B', rgb: { r: 180, g: 180, b: 240 } }) }, '画笔 B'),
            React.createElement('label', { style: { marginLeft: '12px' } },
              ' 分割线：W', React.createElement('input', { type: 'number', value: segmentation.blockWidth, min: 1, style: { width: '60px' }, onChange: (ev) => setSegmentation({ ...segmentation, blockWidth: parseInt(ev.target.value || '1', 10) }) }),
              ' H', React.createElement('input', { type: 'number', value: segmentation.blockHeight, min: 1, style: { width: '60px' }, onChange: (ev) => setSegmentation({ ...segmentation, blockHeight: parseInt(ev.target.value || '1', 10) }) }),
              React.createElement('input', { type: 'checkbox', checked: segmentation.showLabels, onChange: (ev) => setSegmentation({ ...segmentation, showLabels: ev.target.checked }) }), ' 显示标签'
            )
          ),
          React.createElement(BeadsChartReact, chartProps)
        )
      }

      const root = createRoot(document.getElementById('root'))
      root.render(React.createElement(App))
    </script>
  </body>
  </html>