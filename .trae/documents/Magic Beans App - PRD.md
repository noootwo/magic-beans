## 1. 产品概述
Magic Beans App 是桌面优先的拼豆像素编辑器，包含工作空间项目管理与编辑器画布两大核心模块。
面向轻量创作与学习人群，提供本地持久化、便捷导出与基础绘制能力。

## 2. 核心功能

### 2.1 用户角色（如无必要则不区分）
本产品不需要角色区分与登录，所有功能均为本地使用。

### 2.2 功能模块
我们的应用由以下最少可用页面组成：
1. **工作空间（Workspace）**：项目列表网格、新建项目对话框、搜索输入、删除确认、排序（按更新时间降序）、本地持久化（IndexedDB 优先，localStorage 降级）、加载与错误提示。
2. **编辑器（Editor）**：顶部工具栏、左侧缩略图栏、右侧色板与画笔设置、中心画布（PixiRenderer）、底部颜色用量、撤销重做、导出 PNG/SVG/JSON、返回工作空间入口。

### 2.3 页面详情
| 页面名称 | 模块名称 | 功能描述 |
|---------|---------|---------|
| 工作空间 | 项目列表网格 | 展示项目卡片；按 updatedAt 降序；支持空状态与占位骨架；卡片含名称与最近更新时间。 |
| 工作空间 | 新建项目对话框 | 输入项目名称与尺寸（宽/高）；校验名称非空与尺寸范围；提交后创建并写入本地存储；关闭对话。 |
| 工作空间 | 搜索与排序 | 输入关键字进行名称模糊过滤；默认按 updatedAt 降序；清空搜索恢复全量列表。 |
| 工作空间 | 删除确认 | 点删除按钮弹出确认对话；确认后移除项目并持久化；失败时提示错误。 |
| 工作空间 | 持久化与状态 | 首次加载从 IndexedDB 读取；失败则降级至 localStorage；显示加载中与错误提示；刷新后仍能保持数据。 |
| 编辑器 | 画布与渲染 | 使用 PixiRenderer 渲染拼豆网格；支持缩放/平移；绘制笔刷吸附网格；性能平稳。 |
| 编辑器 | 顶部工具栏 | 提供撤销/重做、保存、导出（PNG/SVG/JSON）、返回工作空间入口；显示当前项目名与缩放比例。 |
| 编辑器 | 左侧缩略图 | 展示图层或帧缩略图；支持选择/新建/删除（如需要）；为后续多帧扩展保留占位。 |
| 编辑器 | 右侧色板与画笔 | 选择颜色、画笔尺寸/形状、橡皮擦；颜色收藏与最近使用；快捷键支持（如 B/E）。 |
| 编辑器 | 底部颜色用量 | 实时统计当前画布各色使用数量；大数据量时保持流畅更新。 |
| 编辑器 | 撤销/重做与历史 | 基于操作历史栈，限制 50 步；快捷键 Ctrl+Z/Ctrl+Y；与画布状态同步。 |

## 3. 核心流程
- 工作空间流程：打开应用 → 读取本地项目 → 搜索/排序浏览 → 新建项目（填写名称与尺寸）→ 在列表中查看与删除；数据持久化，刷新后仍在。
- 编辑器流程：从工作空间进入某项目 → 在画布中绘制（缩放/平移/画笔/橡皮）→ 查看底部颜色用量 → 撤销/重做 → 导出 PNG/SVG/JSON → 返回工作空间。

```mermaid
graph TD
  "Workspace (/workspace)" --> "Editor (/editor/:id)"
  "Editor (/editor/:id)" --> "Export (PNG/SVG/JSON)"
  "Editor (/editor/:id)" --> "Back to Workspace"
```

## 4. 用户界面设计
### 4.1 设计风格
- 主色与副色：主色 #3B82F6（蓝），副色 #10B981（绿）；中性灰 #6B7280。
- 按钮样式：圆角、扁平（含轻微阴影与悬停态）；高频操作提供图标按钮。
- 字体与字号：系统字体 + Inter；正文 14px，标题 18–24px；数字信息（用量/尺寸）稍大加粗。
- 布局风格：卡片化网格（工作空间）、三栏工具布局（编辑器，左/中/右），顶部工具栏固定。
- 图标样式：统一使用 AppIcon（Iconify），线性风格，保持一致的尺寸与色彩。

### 4.2 页面设计总览
| 页面名称 | 模块名称 | UI 元素 |
|---------|---------|---------|
| 工作空间 | 项目列表网格 | 卡片式布局；标题+时间；空状态插画或图标；加载骨架；错误提示条；搜索框置顶。 |
| 工作空间 | 新建项目对话框 | 输入框/数值选择器；确定/取消按钮；表单校验提示；浅色遮罩。 |
| 工作空间 | 搜索与排序 | 顶部搜索框（含清空）；下拉或隐式默认排序；标签展示搜索结果数量。 |
| 工作空间 | 删除确认 | 模态确认框；危险态按钮（红）；支持键盘回车/ESC。 |
| 编辑器 | 画布与渲染 | 居中画布容器，深色背景；网格线可调；滚轮缩放、拖拽平移；性能指示角标。 |
| 编辑器 | 顶部工具栏 | 左侧返回、工程名；中间撤销/重做/保存/导出图标按钮；右侧缩放显示与设置。 |
| 编辑器 | 左侧缩略图 | 垂直列表卡；当前项高亮；新建/删除图标按钮；占位留白。 |
| 编辑器 | 右侧色板与画笔 | 色块网格；画笔尺寸滑条；形状选择；最近颜色；橡皮擦开关。 |
| 编辑器 | 底部颜色用量 | 条形或列表统计；颜色样本+数量；实时刷新。 |

### 4.3 响应式
- 桌面优先，移动端自适应；优先保证纵向滚动，无横向滚动。
- 触控优化：移动端手势缩放与拖拽；侧栏可折叠；图标按钮触控区域 >= 40px。
